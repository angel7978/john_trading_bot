# john_trading_bot

<h2>바이낸스 api 발급</h2>
Enable Reading, Enable Spot & Margin Trading, Enable Futures 체크

<h2>config 파일 설정</h2>
config_example.json => config.json 으로 변경 후 내용 채워 넣기

<h2>python 3.7 이상 구동</h2>
> python bb_bot.py config.json


<h2>모듈 설치</h2>
> pip install ccxt <br />
> pip install ta <br />
> pip install matplotlib


<h2>텔레그램 push 받고 싶을 경우</h2>
텔레그램에서 @arbitrage_johnpak_bot 찾아서 start 후 <br />
config 파일 내 telegram_id 부분에 텔레그램 id 넣기 <br />
(안드로이드 세팅 -> 계정 및 백업 -> 계정 관리 -> 텔레그램에서 확인 가능)

<h2>기본 로직 (Long)</h2>
<ul>
<li>시장가 매수, 매도로 거래</li>
<li>지표</li>
<ul>
<li>볼린저밴드 Length 20, Mult 2</li>
<li>RSI Length 14</li>
</ul>
<li>진입 조건</li>
<ul>
<li>30분 캔들 종가가 볼린저밴드 하단 아래일 경우 다음봉 시가에 시장가매수 (10%)</li>
<ul>
<li>직전 BTC 8h/ETH 6h/BCH 8h 캔들 기준 low 값이 볼린저밴드 하단 아래일 경우 하락장이라고 판단하여 롱 진입하지 않음</li>
</ul>
</ul>
<li>if 수익</li>
<ul>
<li>close 값이 볼린저밴드 상단의 4/5 이상일 시 전수 시장가 매도</li>
<li>볼린저 상단 가격에 매도 주문을 넣어놓아 볼린저밴드 상단을 뚫는 꼬리 발생시에도 매도가 될 수 있도록 함</li>
</ul>
<li>if 손실</li>
<ul>
<li>추가매수 조건</li>
<ul>
<li>볼린저밴드 상단 4/5지점보다 평단가가 높은 경우(손실을 보고 있는 경우)에만 추가매수를 함</li>
<li>아래 조건 중 하나라도 해당이 되면 추가매수를 진행 함</li>
<ul>
<li>조건1 : 볼린저밴드 종가기준으로 하단 아래에서 위로 뚫는 양봉 확인시 다음봉 시가에 추가매수</li>
<li>조건2 : 볼린저밴드 이전캔들이 양봉이고 볼린저밴드 하단 아래 and 이번캔들이 양봉이고 볼린저밴드 하단 위 일시 다음봉 시가에 추가매수</li>
<li>조건3 : RSI 30이하에서 이상으로 뚫으면 다음봉 시가에 추가매수</li>
</ul>
</ul>
<li>추가매수 수량</li>
<ul>
<li>볼린저밴드 상단 4/5지점에서 전부 매도 하였을 때 최종 순이익이 1%가 되도록 추가매수 수량 계산</li>
<li>계산된 수량을 구입하는데 사용되는 USDT가 총 보유 USDT의 10%를 넘을 시 최대 10%까지만 사용하도록 함</li>
<li>(평단가 * 보유수량 + 현재가격 * 추매수량) * 101% = 볼린저밴드 상단 4/5가격 * (보유수량 + 추매수량)</li>
<li>ex) 평단가 80, 보유수량 120, 현재가격 70, 볼린저밴드 상단 4/5가격 75라고 가정하면 계산식은 아래와 같음</li>
<ul>
<li>추매수량 = (80 * 101% - 75) * 120 / (75 - 70 * 101%) = 약 161.86개</li>
<li>즉, 매수에 사용한 총 USDT는 80 * 120(진입) + 70 * 161.86(추매) = 20,930.2이며, 이를 볼린저밴드 상단 4/5가격에 모두 매도하였을 시 (120 + 161.86) * 75 = 21,139.5 USDT를 얻을 수 있으므로 최종 순이익률은 약 1%로 계산 되어 짐</li>
</ul>
<li>만약 [현재가격 * 101% > 볼린저밴드 상단 4/5가격] 일 경우 아무리 추가매수를 하더라도 최종 순이익 1%를 만족할 수 없기 때문에 이 경우에는 추가매수를 하지 않음</li>
</ul>
<li>추가매수 기간</li>
<ul>
<li>추가매수 수량이 계산되어지면 이를 한 번에 매수하지 않고 1/3씩 10분의 텀을 두고 매수</li>
<li>09시 30분에 추가매수 수량을 계산하였으면 09시 30분, 09시 40분에, 09시 50분에 각각 추가매수 수량의 1/3씩 매수</li>
<li>30분 봉 내에서 변동성이 심할 경우 안좋은 가격에 한번에 매수하게 되는 리스크를 줄이기 위한 방책임</li>
</ul>
</ul>
<li>S/L 정책</li>
<ul>
<li>총 매수 금액이 원금의 25%가 넘게 되면 보유수량의 절반 매도 후 'if손실' 조건으로 지속 진행</li>
<li>직전 BTC 8h/ETH 6h/BCH 8h 캔들 기준 low 값이 볼린저밴드 하단 아래로 떨어진 경우 Long 포지션 강제 종료</li>
</ul>
<li>포지션 강제 종료</li>
<ul>
<li>포지션 진입 후 12봉이 지난 이후에 볼린저밴드의 폭이 1.5% 이하로 줄어들 경우에 포지션 강제 종료</li>
<li>포지션 종료 조건을 만족하지 않아 로직 상 손절 혹은 익절을 할 시기는 아니나, 볼린저밴드의 폭이 좁아져 이후 방향성이 모호해진 경우 강제로 포지션을 종료하고 다음 포지션 진입에 대비하기 위함</li>
</ul>
<li>바이낸스에서 BTCUSDT, ETHUSDT, BCHUSDT 세개 심볼 x5로 선물 거래</li>
<li>조건 반대로해서 Short 로직 추가</li>
</ul>
